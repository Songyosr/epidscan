% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prep_cas.R
\name{prep_cas}
\alias{prep_cas}
\title{Prepare SaTScan Case File}
\usage{
prep_cas(
  df,
  loc_id,
  time = NULL,
  cases = NULL,
  covars = NULL,
  style = c("casewise", "aggregated"),
  time_precision = c("day", "month", "year", "generic")
)
}
\arguments{
\item{df}{Data frame containing case data.}

\item{loc_id}{Column name for location ID (unquoted).}

\item{time}{Column name for time/date (unquoted, optional).}

\item{cases}{Column name for case counts (unquoted, optional). If NULL, assumes 1 case per row (casewise).}

\item{covars}{Character vector of covariate column names.}

\item{style}{Case input style:
\itemize{
  \item "casewise": Each row is a single case (cases=1).
  \item "aggregated": Rows represent counts.
}}

\item{time_precision}{Time resolution for formatting: "day", "month", "year", or "generic".}
}
\value{
A \code{satscan_table} object of kind "cas".
}
\description{
Prepares a case file for SaTScan, enforcing strict sparsity (no zero-case rows)
and handling time precision formatting.
}
\section{SaTScan File Specification}{

The Case File has the following structure:
\code{<LocationID> <NoCases> <Date> <Covariate1> ...}

\itemize{
  \item \strong{LocationID}: Character or numeric identifier. Matching ID must exist in Geo file.
  \item \strong{NoCases}: Number of cases. For "casewise" style without a count column, this is set to 1.
    Zero-case rows are removed (implicit zeros).
  \item \strong{Date}: Formatted according to \code{time_precision}:
    \itemize{
      \item "day": \code{YYYY/MM/DD}
      \item "month": \code{YYYY/MM}
      \item "year": \code{YYYY}
      \item "generic": Time string/number
    }
  \item \strong{Covariates}: Optional categorical variables.
}
}

\examples{
\dontrun{
# aggregated daily
head(my_daily_data)
#   zipcode       date cases age_group
# 1   10001 2023-01-01     2     child
# 2   10002 2023-01-01     0     child  <-- Removed

cas_obj <- prep_cas(my_daily_data,
    loc_id = zipcode, time = date, cases = cases,
    covars = "age_group", time_precision = "day"
)

# casewise
head(my_cases)
#      id diagnosis_date
# 1 P001     2023-01-15

cas_obj2 <- prep_cas(my_cases, loc_id = id, time = diagnosis_date, style = "casewise", time_precision = "day")
}
}
