% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/epid_satscan.R
\name{epid_satscan}
\alias{epid_satscan}
\title{Tidy Interface for SatScan Analysis}
\usage{
epid_satscan(
  data,
  obs_col,
  pop_col = NULL,
  date_col = NULL,
  id_col = NULL,
  lat_col = NULL,
  long_col = NULL,
  type = "space-time",
  model = "poisson",
  time_precision = NULL,
  geo_type = "latlong",
  start_date = NULL,
  end_date = NULL,
  monitor_mode = "retrospective",
  prospective_start_date = NULL,
  output_dir = NULL,
  verbose = FALSE,
  ...
)
}
\arguments{
\item{data}{Input data. Can be an \code{sf} object (geometry auto-extracted) or a data.frame
(requires lat_col and long_col).}

\item{obs_col}{Column containing observed case counts (unquoted, required).}

\item{pop_col}{Column containing population counts (unquoted, optional for Poisson model).}

\item{date_col}{Column containing dates/times (unquoted, optional for temporal analysis).}

\item{id_col}{Column containing unique location IDs (unquoted). If missing, row numbers used.}

\item{lat_col}{Column containing latitude (unquoted, required if data is not sf).}

\item{long_col}{Column containing longitude (unquoted, required if data is not sf).}

\item{type}{Analysis type. One of:
\itemize{
  \item "purely-spatial" (1)
  \item "purely-temporal" (2)
  \item "space-time" (3, default)
  \item "space-time-permutation" (4)
  \item "spatial-variation-in-temporal-trends" (5)
  \item "space-time-magnitude" (6)
}
Note: "bernoulli" is NOT a valid analysis type; use \code{model="bernoulli"} with an appropriate type (e.g. "purely-spatial").}

\item{model}{Probability model. One of:
\itemize{
  \item "poisson" (0, default)
  \item "bernoulli" (1)
  \item "space-time-permutation" (2)
  \item "ordinal" (3)
  \item "exponential" (4)
  \item "normal" (5)
  \item "continuous-poisson" (6)
  \item "multinomial" (7)
  \item "rank" (8)
}}

\item{time_precision}{Unit of time: "day", "month", "year", "generic", or NULL for auto-detect.
Auto-detection uses Date objects for "day", numeric for "generic".}

\item{geo_type}{String. "latlong" (default) or "cartesian".
If "latlong", `sf` data is transformed to WGS84.
If "cartesian", raw coordinates are used (CoordinatesType=0).}

\item{start_date}{Optional start date (Date, POSIXt, or character).
If NULL, defaults to minimum date in data.}

\item{end_date}{Optional end date (Date, POSIXt, or character).
If NULL, defaults to maximum date in data.}

\item{output_dir}{Directory for SatScan output files. If NULL (default), uses temp directory.}

\item{verbose}{Logical. Print SatScan progress and debug info?}

\item{...}{Additional arguments passed to \code{rsatscan::ss.options()}. Common options include:
\itemize{
  \item MonteCarloReps - Number of Monte Carlo replications (default 999)
  \item MaxSpatialSizeInPopulationAtRisk - Max cluster size as percentage (default 50)
  \item MaxTemporalSize - Max temporal cluster size
}}
}
\value{
A data.frame or sf object with cluster columns added:
  \itemize{
    \item CLUSTER - Cluster ID (1 = most significant)
    \item P_VALUE - Statistical significance
    \item REL_RISK - Relative risk compared to rest of study area
  }
}
\description{
A pipe-friendly wrapper for running SatScan spatial and space-time cluster analyses
directly on data frames or sf objects. Handles file creation, parameter configuration,
and result parsing automatically.
}
\details{
This function requires SatScan to be installed on your system. Set the path using
\code{set_satscan_path()}.

The function internally:
\enumerate{
  \item Extracts geometry from sf objects or lat/long columns
  \item Writes .cas, .pop, and .geo files for SatScan
  \item Configures parameters based on data and user options
  \item Executes SatScan via rsatscan
  \item Parses results and joins cluster info back to input data
}
}
\examples{
\dontrun{
# Basic space-time analysis
set_satscan_path("/Applications/SaTScan.app/Contents/app/satscan")

result <- my_data |>
  epid_satscan(
    obs_col = cases,
    pop_col = population,
    date_col = date,
    id_col = location_id,
    lat_col = latitude,
    long_col = longitude
  )

# Filter significant clusters
clusters <- result |> dplyr::filter(!is.na(CLUSTER), P_VALUE < 0.05)
}

}
\seealso{
\code{\link{set_satscan_path}}, \code{\link{get_satscan_path}}
}
